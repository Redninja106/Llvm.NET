<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>LLVM 8.0 Support | Llvm.NET </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="LLVM 8.0 Support | Llvm.NET ">
    <meta name="generator" content="docfx 2.42.2.0">
    
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="styles/docfx.vendor.css">
    <link rel="stylesheet" href="styles/docfx.css">
    <link rel="stylesheet" href="styles/main.css">
    <meta property="docfx:navrel" content="toc">
    <meta property="docfx:tocrel" content="toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="index.html">
                <img id="logo" class="svg" src="DragonSharp48x48.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="api/index.html" title="API Documentation">API Documentation</a>
                      </li>
                      <li>
                          <a href="articles/index.html" title="Articles">Articles</a>
                      </li>
                      <li>
                          <a href="https://github.com/UbiquityDotNET/Llvm.NET" title="GitHub Repository">GitHub Repository</a>
                      </li>
                      <li>
                          <a href="http://LLVM.org" title="LLVM.org">LLVM.org</a>
                      </li>
                      <li>
                          <a href="http://releases.llvm.org/8.0.0/docs/index.html" title="LLVM Docs">LLVM Docs</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="llvm-80-support">LLVM 8.0 Support</h1>

<h2 id="llvmnetinterop-new-library">Llvm.NET.Interop (New library)</h2>
<p>Llvm.NET 8.0 adds a new library (Llvm.NET.Interop)  that contains the raw P/Invoke
APIs and support needed to inter-operate with the native library. The NuGet package
for the interop library includes the native code binaries as they are tightly coupled.
This package contains the native LibLLVM.dll and the P/Invoke interop support layers.
Llvm.NET uses this library to define a clean projection of LLVM for .NET consumers.
This will, hopefully, allow for future development and enhancement of the Llvm.NET
object model without changing the underlying P/Invoke layers. (e.g.
the Llvm.NET.Interop can &quot;snap&quot; to LLVM versions, but the LLvm.NET model can have
multiple incremental releases) This isn&#39;t a hard/fast rule as it is possible that
getting new functionality in the object model requires new custom extensions. At
this point in time both libraries are built together and share build numbers.
Though, that may change in the future. </p>
<h3 id="auto-generated-pinvoke">Auto-generated P/Invoke</h3>
<p>LLVM-C API now includes most of the debug APIs so, significantly fewer custom
extensions are needed (That&#39;s a good thing!). To try and keep things simpler this
moves the interop back to using code generation for the bulk of the P/Invoke interop.
However, unlike the first use of generation, the <a href="https://github.com/UbiquityDotNET/Llvm.NET/tree/master/src/Interop/LlvmBindingsGenerator">LLVMBindingsGenerator</a>
is much more targeted and includes specialized handling to prevent the need for
additional &quot;by-hand&quot; tweaking of the generated code, such as:</p>
<ol>
<li>Marshaling of strings with the many ways to dispose (or not) a returned string</li>
<li>LLVMBool vs LLVMStatus</li>
<li>&quot;smart ref&quot; handle types, including aliases that should not be released by
client code.</li>
</ol>
<p>The generated code is combined with some fixed support classes to create a new
Llvm.NET.Interop Library and NuGet Package. </p>
<h2 id="new-features">New features</h2>
<ul>
<li>ObjectFile Support<ul>
<li>LLvm.NET.ObjectFile namespace contains support for processing object files using LLVM</li>
</ul>
</li>
<li>Eager compilation JIT<ul>
<li>The OrcJIT now supports eager and lazy compilation for Windows platforms</li>
</ul>
</li>
<li>Full initialization for all the latests supported targets<ul>
<li>Including - BPF, Lanai, WebAssembly, MSP430, NVPTX, AMDGPU, Hexagon, and XCore</li>
</ul>
</li>
<li>Added accessors to allow retrieval/addition of metadata on instructions</li>
</ul>
<h1 id="breaking-changes">Breaking Changes</h1>
<p>This is a Major release and, as such, can, and does, have breaking changes including:</p>
<ol>
<li>New namespace for some classes (Llvm.NET.Interop)</li>
<li>StaticState class is renamed to Llvm.NET.Interop.Library as it is fundamentally 
part of the low level interop (and &quot;StaticState&quot; was always a bad name)</li>
<li>Instructions no longer have a SetDebugLocation, instead that is provided via a new
fluent method on the InstructionBuilder since the normal use is to set the location
on the builder and then generate a sequence of IR instructions for a given expression
in code. </li>
<li>Legacy JIT engine support is dropped. ORCJit is the only supported JIT engine</li>
<li>Context.CreateBasicBlock() now only creates detached blocks, if append to a function
is desired, there is a method on Function to create and append a new block.</li>
<li>PassManager, ModulePassManager, and FunctionPassManager are IDisposable to help apps
ensure that a function pass manager, which is bound to a module, is destroyed before
the module it is bound to.</li>
<li>BitcodeModule.MakeShared and shared refs of modules is removed. (This was created for
OrcJIT use of shared_ptr under the hood, which is no longer used. OrcJit now uses the
same ownership transfer model as the legacy engines. E.g. the ownership for the module
is transferred to the JIT engine)</li>
<li>BitCodeModule is now Disposable backed by a safe handle, this allows for detaching and
invalidating the underlying LLVMModuleRef when the module is provided to the JIT</li>
<li>Renamed Function class to IrFunction to avoid potential collision with common language
keywords</li>
<li>Renamed Select to SelectInstruction to avoid potential collision with language keyword
and make consistent with ReturnInstruction, ResumeInstruction and other similar cases
for instructions.</li>
</ol>
</article>
          </div>
          <div class="contribution-panel mobile-hide">
              <a href="https://github.com/UbiquityDotNET/Llvm.NET/blob/master/docfx/ReleaseNotes.md/#L1" title="Improve this Doc" class="fab btn-warning pull-right"><i class="glyphicon glyphicon-pencil"></i></a>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Copyright (C) 2017-2019, Ubiquity.NET Contributors<br><strong>Build:</strong> 8.0.0-alpha.0.0.ci-BLD.467044441
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
  </body>
</html>
